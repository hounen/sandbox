C==== 6J-SYMBOL FOR INTEGER ARGUMENTS ==================================
      FUNCTION SIXJ_I(J1,J2,J3,J4,J5,J6)
      INTEGER I,J1,J2,J3,J4,J5,J6,IJ1,IJ2,IJ3,IJ4,IJ5,IJ6,
     &        II1,II2,II3,II4,IA1,IA2,IA3,IA4,IB1,IB2,IB3,IB4,
     &        IC1,IC2,IC3,IC4,ID1,ID2,ID3,ID4,
     &        KK1,KK2,KK3,KK4,KK5,KK6,KK7,KK8,KMAX,KMIN,IFIRST
      REAL*8 SIXJ_I,SQFLG,SLG,FLOG,XI
      DIMENSION FLOG(0:100)
      SAVE IFIRST,FLOG
      DATA IFIRST/0/
      SIXJ_I=0.D0

      IF(IFIRST-9999.NE.0) THEN
        FLOG(0)=0.D0
        DO I=1,100
          XI=DBLE(I)
          FLOG(I)=FLOG(I-1)+DLOG(XI)
        ENDDO
      ENDIF
      IFIRST=9999

      IJ1=2*J1
      IJ2=2*J2
      IJ3=2*J3
      IJ4=2*J4
      IJ5=2*J5
      IJ6=2*J6

      IF(MIN0(IJ1,IJ2,IJ3,IJ4,IJ5,IJ6).LT.0) RETURN
      II1=IJ1+IJ2+IJ3
      II2=IJ4+IJ5+IJ3
      II3=IJ1+IJ5+IJ6
      II4=IJ4+IJ2+IJ6
      IF(II1/2*2.NE.II1) RETURN
      IF(II2/2*2.NE.II2) RETURN
      IF(II3/2*2.NE.II3) RETURN
      IF(II4/2*2.NE.II4) RETURN
      IF(IABS(IJ1-IJ2).GT.IJ3.OR.IJ1+IJ2.LT.IJ3) RETURN
      IF(IABS(IJ4-IJ5).GT.IJ3.OR.IJ4+IJ5.LT.IJ3) RETURN
      IF(IABS(IJ1-IJ5).GT.IJ6.OR.IJ1+IJ5.LT.IJ6) RETURN
      IF(IABS(IJ4-IJ2).GT.IJ6.OR.IJ4+IJ2.LT.IJ6) RETURN

      IF(MIN0(IJ1,IJ2,IJ3,IJ4,IJ5,IJ6).EQ.0) THEN
      ENDIF

      IA4=(IJ1+IJ2+IJ3)/2
      IA1=IA4-IJ1
      IA2=IA4-IJ2
      IA3=IA4-IJ3
      IA4=IA4+1
      IB4=(IJ4+IJ5+IJ3)/2
      IB1=IB4-IJ4
      IB2=IB4-IJ5
      IB3=IB4-IJ3
      IB4=IB4+1
      IC4=(IJ1+IJ5+IJ6)/2
      IC1=IC4-IJ1
      IC2=IC4-IJ5
      IC3=IC4-IJ6
      IC4=IC4+1
      ID4=(IJ4+IJ2+IJ6)/2
      ID1=ID4-IJ4
      ID2=ID4-IJ2
      ID3=ID4-IJ6
      ID4=ID4+1
      SQFLG=0.5D0*(FLOG(IA1)+FLOG(IA2)+FLOG(IA3)-FLOG(IA4)
     &            +FLOG(IB1)+FLOG(IB2)+FLOG(IB3)-FLOG(IB4)
     &            +FLOG(IC1)+FLOG(IC2)+FLOG(IC3)-FLOG(IC4)
     &            +FLOG(ID1)+FLOG(ID2)+FLOG(ID3)-FLOG(ID4))
   
      KK2=(IJ1+IJ2+IJ3)/2
      KK3=(IJ1+IJ5+IJ6)/2
      KK4=(IJ4+IJ2+IJ6)/2
      KK5=(IJ4+IJ5+IJ3)/2
      KK6=(IJ1+IJ2+IJ4+IJ5)/2
      KK7=(IJ2+IJ3+IJ5+IJ6)/2
      KK8=(IJ1+IJ3+IJ4+IJ6)/2
      KMIN=MAX0(KK2,KK3,KK4,KK5)
      KMAX=MIN0(KK6,KK7,KK8)
      IF(KMIN.GT.KMAX) RETURN
      DO KK1=KMIN,KMAX
        SLG=SQFLG+FLOG(KK1+1)-FLOG(KK1-KK2)-FLOG(KK1-KK3)-FLOG(KK1-KK4)
     &     -FLOG(KK1-KK5)-FLOG(KK6-KK1)-FLOG(KK7-KK1)-FLOG(KK8-KK1)
        SIXJ_I=SIXJ_I+(-1.D0)**KK1*DEXP(SLG)
      ENDDO
      RETURN
      END
C=======================================================================

C==== 6J-SYMBOL FOR DOUBLE PRECISION ARGUMENTS =========================
      FUNCTION SIXJ_D(J1,J2,J3,J4,J5,J6)
      INTEGER I,IJ1,IJ2,IJ3,IJ4,IJ5,IJ6,
     &        II1,II2,II3,II4,IA1,IA2,IA3,IA4,IB1,IB2,IB3,IB4,
     &        IC1,IC2,IC3,IC4,ID1,ID2,ID3,ID4,
     &        KK1,KK2,KK3,KK4,KK5,KK6,KK7,KK8,KMAX,KMIN,IFIRST
      REAL*8 J1,J2,J3,J4,J5,J6,SIXJ_D,SQFLG,SLG,FLOG,XI
      DIMENSION FLOG(0:100)
      SAVE IFIRST,FLOG
      DATA IFIRST/0/
      SIXJ_D=0.D0

      IF(IFIRST-9999.NE.0) THEN
        FLOG(0)=0.D0
        DO I=1,100
          XI=DBLE(I)
          FLOG(I)=FLOG(I-1)+DLOG(XI)
        ENDDO
      ENDIF
      IFIRST=9999

      IJ1=IDINT(2.D0*J1+0.01D0)
      IJ2=IDINT(2.D0*J2+0.01D0)
      IJ3=IDINT(2.D0*J3+0.01D0)
      IJ4=IDINT(2.D0*J4+0.01D0)
      IJ5=IDINT(2.D0*J5+0.01D0)
      IJ6=IDINT(2.D0*J6+0.01D0)

      IF(MIN0(IJ1,IJ2,IJ3,IJ4,IJ5,IJ6).LT.0) RETURN
      II1=IJ1+IJ2+IJ3
      II2=IJ4+IJ5+IJ3
      II3=IJ1+IJ5+IJ6
      II4=IJ4+IJ2+IJ6
      IF(II1/2*2.NE.II1) RETURN
      IF(II2/2*2.NE.II2) RETURN
      IF(II3/2*2.NE.II3) RETURN
      IF(II4/2*2.NE.II4) RETURN
      IF(IABS(IJ1-IJ2).GT.IJ3.OR.IJ1+IJ2.LT.IJ3) RETURN
      IF(IABS(IJ4-IJ5).GT.IJ3.OR.IJ4+IJ5.LT.IJ3) RETURN
      IF(IABS(IJ1-IJ5).GT.IJ6.OR.IJ1+IJ5.LT.IJ6) RETURN
      IF(IABS(IJ4-IJ2).GT.IJ6.OR.IJ4+IJ2.LT.IJ6) RETURN

      IF(MIN0(IJ1,IJ2,IJ3,IJ4,IJ5,IJ6).EQ.0) THEN
      ENDIF

      IA4=(IJ1+IJ2+IJ3)/2
      IA1=IA4-IJ1
      IA2=IA4-IJ2
      IA3=IA4-IJ3
      IA4=IA4+1
      IB4=(IJ4+IJ5+IJ3)/2
      IB1=IB4-IJ4
      IB2=IB4-IJ5
      IB3=IB4-IJ3
      IB4=IB4+1
      IC4=(IJ1+IJ5+IJ6)/2
      IC1=IC4-IJ1
      IC2=IC4-IJ5
      IC3=IC4-IJ6
      IC4=IC4+1
      ID4=(IJ4+IJ2+IJ6)/2
      ID1=ID4-IJ4
      ID2=ID4-IJ2
      ID3=ID4-IJ6
      ID4=ID4+1
      SQFLG=0.5D0*(FLOG(IA1)+FLOG(IA2)+FLOG(IA3)-FLOG(IA4)
     &            +FLOG(IB1)+FLOG(IB2)+FLOG(IB3)-FLOG(IB4)
     &            +FLOG(IC1)+FLOG(IC2)+FLOG(IC3)-FLOG(IC4)
     &            +FLOG(ID1)+FLOG(ID2)+FLOG(ID3)-FLOG(ID4))
   
      KK2=(IJ1+IJ2+IJ3)/2
      KK3=(IJ1+IJ5+IJ6)/2
      KK4=(IJ4+IJ2+IJ6)/2
      KK5=(IJ4+IJ5+IJ3)/2
      KK6=(IJ1+IJ2+IJ4+IJ5)/2
      KK7=(IJ2+IJ3+IJ5+IJ6)/2
      KK8=(IJ1+IJ3+IJ4+IJ6)/2
      KMIN=MAX0(KK2,KK3,KK4,KK5)
      KMAX=MIN0(KK6,KK7,KK8)
      IF(KMIN.GT.KMAX) RETURN
      DO KK1=KMIN,KMAX
        SLG=SQFLG+FLOG(KK1+1)-FLOG(KK1-KK2)-FLOG(KK1-KK3)-FLOG(KK1-KK4)
     &     -FLOG(KK1-KK5)-FLOG(KK6-KK1)-FLOG(KK7-KK1)-FLOG(KK8-KK1)
        SIXJ_D=SIXJ_D+(-1.D0)**KK1*DEXP(SLG)
      ENDDO
      RETURN
      END
C=======================================================================
